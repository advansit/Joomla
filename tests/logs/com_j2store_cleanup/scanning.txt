=== Scanning Tests (Version-Aware Detection) ===

--- Joomla 4 ---
Test: J4: JModelLegacy flagged... PASS
Test: J4: JFactory NOT flagged... PASS
Test: J4: Factory::getUser() NOT flagged... PASS

--- Joomla 5 ---
Test: J5: JTable flagged... PASS
Test: J5: JFactory NOT flagged (B/C plugin)... PASS
Test: J5: Factory::getDbo() NOT flagged... PASS

--- Joomla 6 ---
Test: J6: JFactory flagged... PASS
Test: J6: JText flagged... PASS
Test: J6: JRoute flagged... PASS
Test: J6: Factory::getUser() flagged... PASS
Test: J6: Factory::getDbo() flagged... PASS
Test: J6: Factory::getSession() flagged... PASS
Test: J6: Factory::getDocument() flagged... PASS
Test: J6: $this->app flagged... PASS
Test: J6: JPlugin also flagged (J4 removal still applies)... PASS

--- Clean modern code ---
Test: Clean code: no issues on J6... PASS
Test: Clean code: no issues on J5... PASS
Test: Clean code: no issues on J4... PASS

--- J2Commerce F0F ---
Test: F0FModel NOT flagged on J6... PASS

--- Comment stripping ---
Test: Commented code not flagged... PASS

--- Non-PHP files ---
Test: Non-PHP files ignored... PASS

--- Edge cases ---
Test: Empty dir: no issues... PASS
Test: Nonexistent dir: no issues... PASS

--- Deduplication ---
Test: JFactory deduplicated across files... PASS

=== Scanning Test Summary ===
Passed: 24
Failed: 0
Total:  24
